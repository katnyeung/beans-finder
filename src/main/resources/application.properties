# Application
spring.application.name=beans-finder

# Database Configuration (PostgreSQL / Neon)
spring.datasource.url=${DATABASE_URL:jdbc:postgresql://localhost:5432/coffee_db}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME:postgres}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD:password}
spring.datasource.driver-class-name=org.postgresql.Driver

# JPA / Hibernate Configuration
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# Neo4j Configuration
spring.neo4j.uri=${NEO4J_URI:bolt://localhost:7687}
spring.neo4j.authentication.username=${NEO4J_USER:neo4j}
spring.neo4j.authentication.password=${NEO4J_PASSWORD:password}

# API Configuration
# Perplexity: For web search, URL filtering, brand discovery
perplexity.api.key=${PERPLEXITY_API_KEY:}
perplexity.api.url=https://api.perplexity.ai/chat/completions
perplexity.api.model=sonar-pro

# OpenAI: For text extraction from Playwright-rendered content (20x cheaper than Perplexity)
openai.api.key=${OPENAI_API_KEY:}
openai.api.url=https://api.openai.com/v1/chat/completions
openai.model=gpt-4o-mini
openai.temperature=0.1
openai.max.tokens=1000

# Grok: For RAG-powered chatbot with Neo4j knowledge graph
grok.api.key=${GROK_API_KEY:}
grok.api.url=https://api.x.ai/v1/chat/completions
grok.model=grok-4-fast-reasoning
grok.temperature=0.3
grok.max.tokens=1500

# Redis Configuration
spring.redis.host=${REDIS_HOST:localhost}
spring.redis.port=${REDIS_PORT:6379}
spring.redis.timeout=2000ms
spring.cache.type=redis
spring.cache.redis.time-to-live=86400000
spring.cache.redis.cache-null-values=false

# Chatbot Configuration
chatbot.max.context.products=15
chatbot.conversation.ttl.minutes=60

# Rate Limiting Configuration (configurable via env vars)
chatbot.ratelimit.per.minute=${CHATBOT_RATE_LIMIT_PER_MINUTE:5}
chatbot.ratelimit.per.day=${CHATBOT_RATE_LIMIT_PER_DAY:100}

# Cost Control Configuration (configurable via env vars)
chatbot.cost.daily.limit=${CHATBOT_COST_DAILY_LIMIT:1.00}

# Input Validation
chatbot.query.max.length=500

# Semantic Cache Configuration (LangCache)
chatbot.semantic.cache.enabled=true
chatbot.semantic.cache.similarity.threshold=0.92
chatbot.semantic.cache.ttl.hours=1

# Crawler Configuration
crawler.delay.seconds=2
crawler.retry.attempts=3
crawler.update.interval.days=14
crawler.user.agent=Mozilla/5.0 (compatible; CoffeeBeansFinder/1.0)
crawler.playwright.chunk.size=10

# Scheduling (Enable scheduling)
spring.task.scheduling.pool.size=2

# Logging
logging.level.com.coffee=INFO
logging.level.org.springframework.data.neo4j=INFO
# Suppress Neo4j deprecation warnings (known issue with Spring Data Neo4j auto-generated queries)
logging.level.org.springframework.data.neo4j.cypher.deprecation=ERROR
logging.level.org.springframework.data.neo4j.cypher.unrecognized=ERROR
logging.level.com.coffee.beansfinder.service.NominatimGeolocationService=DEBUG
logging.level.com.coffee.beansfinder.service.OpenAIService=DEBUG